# it.burberry.com
ANNOUNCEMENTS-WOMAN 女性用
https://it.burberry.com/web-api/pages/products?location=/cat1350151/cat1350155/cat6910020&pagePath=/2/nuovi-arrivi-donna-novita/&offset=1&limit=1&country=JP&language=jp

ANNOUNCEMENTS-MAN 男性用
location: /cat1350556/cat1350564/cat7170024
offset: 20
limit: 20
pagePath: /l/novita-per-uomo/
language: it
country: IT

ANNOUNCEMENTS-CHILD 子供用
location: /cat1350882/cat3300042/cat8610034
offset: 20
limit: 20
pagePath: /l/nuovi-arrivi-bambino/
language: it
country: IT

ANNOUNCEMENTS-Jackets and Coat ジャケットとコート
location: /cat1350556/cat8460076/cat8460086
offset: 20
limit: 10
pagePath: /l/giacche-e-cappotti-uomo/
language: it
country: IT

BAG of WOMAN 女性用バッグ
location: /cat1350151/cat1350397/cat6720026
offset: 20
limit: 20
pagePath: /borse-donna/
language: it
country: IT

BAG OF MAN 男性用バッグ
location: /cat1350556/cat8800113/cat8800115
offset: 40
limit: 20
pagePath: /borse-uomo/
language: it
country: IT

WOMEN'S GIFT ITEMS 女性用ギフトアイテム
location: /cat1350151/cat1360092/cat4020120
offset: 40
limit: 20
pagePath: /articoli-da-regalo-donna/
language: it
country: IT

MEN'S GIFT ITEMS 男性用ギフトアイテム
location: /cat1350556/cat1360241/cat8040016
offset: 60
limit: 20
pagePath: /articoli-da-regalo-uomo/
language: it
country: IT

GIFTS for Children 子供用ギフトアイテム
location: /cat1350882/cat1360297/cat5980059
offset: 20
limit: 1
pagePath: /articoli-da-regalo-bambini/
language: it
country: IT


# buyma data sheet
- Validate
{
  "id": null,
  "name": "商品名001",
  "comment": "品質、素材、付属品の有無のほか、商品の魅力や特徴も記載してください。",
  "category_id": 3421,
  "brand": {
    "id": 246,
    "text": "Louis Vuitton",
    "phonetic": "ルイヴィトン"
  },
  "season_id": null,
  "theme_id": null,
  "shipping_methods": [
    {
      "id": 816077,
      "haiso_cd": 313,
      "price": 0,
      "bill_type": "sender"
    }
  ],
  "shop_name": "",
  "period": "2022-09-20T14:08:23.448Z",
  "tags": [],
  "memo": "",
  "purchase_area": {
    "area_cd": "1000001",
    "city_cd": "000",
    "group_cd": "2003",
    "region": "overseas"
  },
  "shipping_area": {
    "area_cd": "1000040",
    "city_cd": "000",
    "group_cd": "1000",
    "region": "domestic"
  },
  "colors": [
    {
      "master_id": 1,
      "name": "white",
      "_id": "e204f336-b7cf-4c5a-8c52-de4d4335c894"
    },
    {
      "master_id": 2,
      "name": "Black",
      "_id": "ba98bd5f-0352-4877-aa2a-4892f1aa8533"
    }
  ],
  "sizes": [
    {
      "name": "10",
      "master_id": 1,
      "details": [
        {
          "master_id": 5,
          "name": "ウエスト",
          "value": ""
        }
      ]
    },
    {
      "name": "15",
      "master_id": 1,
      "details": [
        {
          "master_id": 5,
          "name": "ウエスト",
          "value": ""
        }
      ]
    }
  ],
  "size_unit_id": 2,
  "colorsizes": [
    [
      {
        "selectable": 1,
        "amount": ""
      },
      {
        "selectable": 1,
        "amount": ""
      }
    ],
    [
      {
        "selectable": 1,
        "amount": ""
      },
      {
        "selectable": 1,
        "amount": ""
      }
    ]
  ],
  "variations_note": "色・サイズ補足情報色・サイズ補足情報色・サイズ補足情報",
  "model_id": 0,
  "price": 15000,
  "reference_price": null,
  "reference_price_type": "none",
  "variable_price_type": "none",
  "include_duty": false,
  "duty_type": "prepaid",
  "style_numbers": [],
  "deleted_style_numbers": [],
  "shop_urls": [],
  "deleted_shop_urls": [],
  "unit_summary": 0,
  "reference_number": "",
  "insdate": null,
  "kokaidate": null,
  "access": {
    "total": 0,
    "last_7days": 0
  },
  "global_status": "not_allowed",
  "editable_regular_price": false,
  "legacy_prices": null,
  "is_responsed": false,
  "is_delegated": false,
  "offer_nickname": "",
  "is_stock_changeable": true,
  "is_resale": false,
  "resale_verification": "",
  "admin_item_return_box_detail_url": "",
  "is_auto_reflected_size": false,
  "status": "publish",
  "item_images": [
    {
      "position": 1,
      "image_key": "eE5pdzY2YXdVd3d5Z3lDZ1U3VWdTdz09LS1JNDVPRGswUkY4VW5wTXU1c1BjT1pRPT0=--4485fca2cac0d72c843b2eadfe079587d907c118",
      "image_index": 1,
      "_destroy": false
    }
  ],
  "capacity_amount": 10
}

- Add Products
~~~~~~~~~~~~~~~~~
accept-ranges: bytes
access-control-allow-credentials: true
access-control-allow-methods: GET, POST, DELETE, PUT, PATCH, OPTIONS
access-control-allow-origin: https://www.buyma.com
access-control-expose-headers
access-control-max-age: 86400
cache-control: max-age=0, no-cache, no-store
content-encoding: gzip
content-security-policy-report-only: default-src data: https: 'unsafe-inline' 'unsafe-eval'; report-uri https://track.buyma.com/csp/report.json
content-type: application/json; charset=utf-8
date: Tue, 06 Sep 2022 14:16:51 GMT
expires: Tue, 06 Sep 2022 14:16:51 GMT
pragma: no-cache
set-cookie: _bTcSnK2z_1=MQ%3D%3D%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT
set-cookie: _9UoYx0yr_2=MjAyMi8wOS8wNiAyMzoxNjo1MQ%3D%3D%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT
set-cookie: _9UoYx0yr_9=MjAyMi8wOS8wNiAyMzoxNjo1MQ%3D%3D%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT
set-cookie: _gWy89cor_3=MjAyMi85LzYgMjI6NTQ6MzA%3D%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT
set-cookie: _nRv3Hphs_4=aHR0cHM6Ly93d3cuYnV5bWEuY29tLw%3D%3D%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT
set-cookie: _bom4g50s_7=MmE0ZWRhNGItMGRkMy00NWY5LWFiZmItOGVhOGEyZTkwMzE5%0A; domain=.www.buyma.com; path=/; expires=Fri, 06-Sep-2052 14:16:51 GMT; Secure; SameSite=None
set-cookie: bm_absw=abtest_20220620_a; path=/; expires=Fri, 30-Sep-2022 15:00:00 GMT
set-cookie: abtest_ios=a; path=/; expires=Sun, 30-Mar-2200 15:00:00 GMT
set-cookie: abtest_android=b; path=/; expires=Sun, 30-Mar-2200 15:00:00 GMT
set-cookie: abtest_recommend=abtest_20210701_f; path=/; expires=Tue, 31-Jan-2023 15:00:00 GMT
set-cookie: _haYwNOv9KAjMwqN4rZXF48H0=eyJsYXN0X2FjY2Vzc190aW1lIjoiMjAyMjA5MDYyMzE2NTEiLCJ0b2tlbiI6%0AIjQwNWIzNmMyNWY0OWE5ODljYTIzYjY4Y2ZlYTI4N2ZiNGMwNGJlNjkifQ%3D%3D%0A; domain=.www.buyma.com; path=/
set-cookie: xLeEnupuY11Od7qj7DPcs0UJ=bf7078aa9da96c3e44dfe7a7ccd5505dcc98e3c25c109e34d7122136c9ebe8f1; path=/; expires=Tue, 06-Sep-2022 15:16:51 GMT; HttpOnly; Secure; SameSite=None
set-cookie: _bTcSnK2z_1=MQ==; Domain=.www.buyma.com; Path=/; Expires=Fri, 06 Sep 2052 14:16:51 GMT
set-cookie: _9UoYx0yr_2=MjAyMi85LzYgMjM6MTY6NTE=; Domain=.www.buyma.com; Path=/; Expires=Fri, 06 Sep 2052 14:16:51 GMT
set-cookie: _gWy89cor_3=MjAyMi85LzYgMjI6NTQ6MzA=; Domain=.www.buyma.com; Path=/; Expires=Fri, 06 Sep 2052 14:16:51 GMT
set-cookie: _nRv3Hphs_4=aHR0cHM6Ly93d3cuYnV5bWEuY29tLw==; Domain=.www.buyma.com; Path=/; Expires=Fri, 06 Sep 2052 14:16:51 GMT
set-cookie: _bom4g50s_7=MmE0ZWRhNGItMGRkMy00NWY5LWFiZmItOGVhOGEyZTkwMzE5; Domain=.www.buyma.com; Path=/; Expires=Fri, 06 Sep 2052 14:16:51 GMT
status: 201 Created
vary: User-Agent,Accept-Encoding
via: 1.1 varnish
x-cache: MISS
x-cache-hits: 0
x-served-by: cache-hel1410027-HEL
x-timer: S1662473810.187384,VS0,VE1750
x-ua-compatible: IE=Edge,chrome=1
:authority: www.buyma.com
:method: POST
:path: /rorapi/sell/products
:scheme: https
accept: application/json, text/plain, */*
accept-encoding: gzip, deflate, br
accept-language: ja,en-US;q=0.9,en;q=0.8
content-length: 2070
content-type: application/json;charset=UTF-8
cookie: abtest_ios=a; _ga=GA1.1.1033361649.1662472369; bm_absw=abtest_20220620_a; mycoupon_new_arrival=true; mycoupon_check_minutes=1800; last_mycoupon_check=2022%2F8%2F6%2022%3A52%3A49; abtest_android=b; abtest_recommend=abtest_20210701_f; xLeEnupuY11Od7qj7DPcs0UJ=bf7078aa9da96c3e44dfe7a7ccd5505dcc98e3c25c109e34d7122136c9ebe8f1; announceGlobal=1; root_redirection=%2Fmens%2F; ses=74ab750a1ad330278758c31fc3e03a82; _GEWZxdbe2H2bte4N=NGI5MjA3OTlhMTU1MDgzOTUyMmZhZWIxM2VhZDFmNTVkM2E4MmFiNDU1MGY2NWYwMDg2ZTJiODQzMDk5ZThlOQ%3D%3D; _4qtJgvsYhkQO9t8W=39179f476c53d85d64bb742925b705fd8a604f16f94094e16e877bbd6c9fc8b4; _ak3lsdf981lSdf1ldkia1e=eyJsYXN0X2xvZ2luX3RpbWUiOiIyMDIyMDkwNjIyNTk0NCIsInRva2VuIjoiNDBlNDZmYjA5ZTAzYjQ0MmVhZTY5NGQ3ZTY2ZTNhODJlMTBmYmFlNCJ9; bm_cart=80d0b502b8f8b9851c4705fcf824eb21; _DBOngl29f311ALR78vy7WVXn=; dvssfouubc=b; bm_gender=%22Male%22; bm_is_buyer=true; bm_generation=3; card_issuable=0; my_page_ps_dashboard=0; sell_bulk_accessible_user=0; _tpZxzksYC2pJSKSm7YpkaE24=%7B%22kaiin_id%22%3A8792318%2C%22nickname%22%3A%22%E3%83%87%E3%82%A3%E3%83%8B%E3%83%BC%E3%82%BF%22%2C%22hashed_mailaddr%22%3A%2216b9793497c05293c42171fdaa35d127%22%2C%22point%22%3A0%2C%22point_back_rate%22%3A%220%22%2C%22sokuwari_total_price%22%3A0%2C%22sokuwari_prices%22%3A%5B%5D%2C%22stage_id%22%3A0%2C%22stage_name%22%3Anull%2C%22mail_certificate_status%22%3A1%2C%22is_buyer%22%3Atrue%2C%22is_timesale_buyer%22%3Afalse%2C%22buyer_kbn%22%3A%220%22%2C%22buyer_app%22%3A%220%22%2C%22is_exhibition_prohibited%22%3Afalse%2C%22is_on_blacklist%22%3Afalse%2C%22accepts_item_relation%22%3Atrue%2C%22denys_item_relation%22%3Afalse%2C%22is_domestic%22%3Atrue%2C%22invitation_code%22%3A%22c4%252BBFQPMswk%22%2C%22gender%22%3A%22Male%22%2C%22age%22%3A35%2C%22generation%22%3A3%2C%22is_line_user%22%3Afalse%2C%22event_ids%22%3A%5B%5D%2C%22is_unpurchased_user%22%3Afalse%2C%22purchase_count%22%3A1%2C%22loyal_customer%22%3Afalse%2C%22encoded_kaiin_id_token%22%3A%22eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJidXltYS5jb20iLCJhdWQiOiJpdGVtLWRpc2NvdW50LmJ1eW1hLmNvbSIsImV4cCI6MTY2MjQ4MDI5OSwiaWF0IjoxNjYyNDczMDk5LCJrYWlpbl9pZCI6Ijg3OTIzMTgifQ.OGPIYyRQVjUJGp9kbIe7k6Z86cOS_SHTRfhZP-zxBbg%22%2C%22available_buymacard%22%3Atrue%2C%22buyma_contents_authentication_token%22%3A%22eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJidXltYS5jb20iLCJhdWQiOiJjb250ZW50cy5zcnYuYnV5bWEuY29tIiwiZXhwIjoxNjYyNTE2Mjk5LCJpYXQiOjE2NjI0NzMwOTksInN1YiI6ODc5MjMxOH0.2WlTzDeOAbxuSoyzwb3wVNXBw59PERHupOjvgDgjHL8%22%2C%22cart_status%22%3A%7B%22buy_cart_count%22%3A0%7D%2C%22menu_status%22%3A%7B%22buyer_orders%22%3A0%2C%22buyorders%22%3A0%2C%22new_buyer_orders%22%3A0%7D%2C%22buyorder_status%22%3A%7B%22received_count%22%3A1%7D%2C%22last_saved%22%3A1662473303280%2C%22api_version%22%3A2.5%7D; _ga_JQ8NVJYXJM=GS1.1.1662472368.1.1.1662473477.60.0.0; _9UoYx0yr_9=MjAyMi8wOS8wNiAyMzoxNjowOA%3D%3D%0A; _haYwNOv9KAjMwqN4rZXF48H0=eyJsYXN0X2FjY2Vzc190aW1lIjoiMjAyMjA5MDYyMzE2MDgiLCJ0b2tlbiI6%0AIjQwNWIzNmMyNWY0OWE5ODljYTIzYjY4Y2ZlYTI4N2ZiNGMwNGJlNjkifQ%3D%3D%0A; _bTcSnK2z_1=MQ==; _9UoYx0yr_2=MjAyMi85LzYgMjM6MTY6MDg=; _gWy89cor_3=MjAyMi85LzYgMjI6NTQ6MzA=; _nRv3Hphs_4=aHR0cHM6Ly93d3cuYnV5bWEuY29tLw==; _bom4g50s_7=MmE0ZWRhNGItMGRkMy00NWY5LWFiZmItOGVhOGEyZTkwMzE5
origin: https://www.buyma.com
referer: https://www.buyma.com/my/sell/new?tab=b
sec-ch-ua: "Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
sec-fetch-dest: empty
sec-fetch-mode: cors
sec-fetch-site: same-origin
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36
x-csrf-token: qSvEzysqX1GCTcWh3VAbIQEQvYO9IIGivsetV7szALA=
x-requested-with: XMLHttpRequest

https://www.buyma.com/rorapi/sell/products
{
  "id": null,
  "name": "商品名001",
  "comment": "品質、素材、付属品の有無のほか、商品の魅力や特徴も記載してください。",
  "category_id": 3421,
  "brand": {
    "id": 246,
    "text": "Louis Vuitton",
    "phonetic": "ルイヴィトン"
  },
  "season_id": null,
  "theme_id": null,
  "shipping_methods": [
    {
      "id": 816077,
      "haiso_cd": 313,
      "price": 0,
      "bill_type": "sender"
    }
  ],
  "shop_name": "",
  "period": "2022-09-20T14:08:23.448Z",
  "tags": [],
  "memo": "",
  "purchase_area": {
    "area_cd": "1000001",
    "city_cd": "000",
    "group_cd": "2003",
    "region": "overseas"
  },
  "shipping_area": {
    "area_cd": "1000040",
    "city_cd": "000",
    "group_cd": "1000",
    "region": "domestic"
  },
  "colors": [
    {
      "master_id": 1,
      "name": "white",
      "_id": "e204f336-b7cf-4c5a-8c52-de4d4335c894"
    },
    {
      "master_id": 2,
      "name": "Black",
      "_id": "ba98bd5f-0352-4877-aa2a-4892f1aa8533"
    }
  ],
  "sizes": [
    {
      "name": "10",
      "master_id": 1,
      "details": [
        {
          "master_id": 5,
          "name": "ウエスト",
          "value": ""
        }
      ]
    },
    {
      "name": "15",
      "master_id": 1,
      "details": [
        {
          "master_id": 5,
          "name": "ウエスト",
          "value": ""
        }
      ]
    }
  ],
  "size_unit_id": 2,
  "colorsizes": [
    [
      {
        "selectable": 1,
        "amount": ""
      },
      {
        "selectable": 1,
        "amount": ""
      }
    ],
    [
      {
        "selectable": 1,
        "amount": ""
      },
      {
        "selectable": 1,
        "amount": ""
      }
    ]
  ],
  "variations_note": "色・サイズ補足情報色・サイズ補足情報色・サイズ補足情報",
  "model_id": 0,
  "price": 15000,
  "reference_price": null,
  "reference_price_type": "none",
  "variable_price_type": "none",
  "include_duty": false,
  "duty_type": "prepaid",
  "style_numbers": [],
  "deleted_style_numbers": [],
  "shop_urls": [],
  "deleted_shop_urls": [],
  "unit_summary": 0,
  "reference_number": "",
  "insdate": null,
  "kokaidate": null,
  "access": {
    "total": 0,
    "last_7days": 0
  },
  "global_status": "not_allowed",
  "editable_regular_price": false,
  "legacy_prices": null,
  "is_responsed": false,
  "is_delegated": false,
  "offer_nickname": "",
  "is_stock_changeable": true,
  "is_resale": false,
  "resale_verification": "",
  "admin_item_return_box_detail_url": "",
  "is_auto_reflected_size": false,
  "status": "publish",
  "item_images": [
    {
      "position": 1,
      "image_key": "eE5pdzY2YXdVd3d5Z3lDZ1U3VWdTdz09LS1JNDVPRGswUkY4VW5wTXU1c1BjT1pRPT0=--4485fca2cac0d72c843b2eadfe079587d907c118",
      "image_index": 1,
      "_destroy": false
    }
  ],
  "capacity_amount": 10
}


# --スクレイピング-----------------------------------------
from selenium import webdriver
import datetime
import time
# --デスクトップアプリ-------------------------------------
import tkinter as tk 
from tkinter import scrolledtext
import threading
class BrowserController():
    def __init__(self, tkinterController, setting_params):
        self.tkinterController = tkinterController
        self.base_url        = 'https://www.buyma.com'
        self.login_id        = setting_params['input_login_id']
        self.login_password  = setting_params['input_login_password']
        self.target_page_url = setting_params['input_url']
    def open_buyma(self):
        options = webdriver.ChromeOptions()
        options.add_argument('--ignore-certificate-errors')
        options.add_argument('--ignore-ssl-errors')
        self.browser = webdriver.Chrome(executable_path = 'C://xxx//xxx//xxx//chromedriver.exe', chrome_options=options)
        self.browser.implicitly_wait(3)
        self.browser.maximize_window()
        self.browser.get(self.base_url)
        time.sleep(3)
        self.tkinterController.activate_logging('ページが表示されました。')
        return
    def login_buyma(self):
        # ポップアップを閉じる
        self.browser.find_element_by_class_name('fab-cp-modal__close').click()
        # ログインボタンを押す
        self.browser.find_element_by_id('js-pc-header-login-link').click()
        # ログインIDを入力する
        self.browser.find_element_by_id('txtLoginId').send_keys(self.login_id)
        # パスワードを入力する
        self.browser.find_element_by_id('txtLoginPass').send_keys(self.login_password)
        time.sleep(3)
        # ログインボタンを押す
        self.browser.find_element_by_id('login_do').click()
        time.sleep(2)
        self.tkinterController.activate_logging('ログインが完了しました。')
        return
    def get_item_urls(self):
        # 初期化
        page_index = 0
        first_page = True
        is_data    = False
        item_urls  = []
        # データが取得できなくなったら終了
        while first_page or is_data:
            # 初期ページフラグ無効化
            first_page = False
            # ページ用URLを生成
            page_index = page_index + 1
            suffix_url = f'_{str(page_index)}'
            # 一番後ろの「/」にページ番号を付与
            target_page_url = self.target_page_url.split('/')
            target_page_url.insert(-1, suffix_url)
            target_page_url = '/'.join(target_page_url)
            # URLを開く
            self.browser.get(target_page_url)
            time.sleep(2)
            # アイテム情報を配列で取得
            items = self.browser.find_elements_by_class_name('product')
            if items:
                # 継続フラグを有効化
                is_data = True
                # アイテム情報が存在する場合アイテム個別のURLを取得
                for item in items:
                    end_of_item_url = item.find_element_by_tag_name('div').get_attribute('item-url')
                    item_url = self.base_url + end_of_item_url
                    item_urls.append(item_url)
                self.tkinterController.activate_logging(target_page_url+'の情報を取得しました。')
            else:
                # 継続フラグを無効化
                is_data = False
                self.tkinterController.activate_logging('全てのページの情報を取得しました。')
        return item_urls
    def open_item_urls_for_each(self, item_urls):
        for item_url in item_urls:
            self.browser.get(item_url)
            """
            ここにアイテムの詳細情報を取得するプログラムを記述する
            """
            self.tkinterController.activate_logging(item_url+'の情報を取得しました。')
            time.sleep(3)
        return
class TkinterController():
    def __init__(self):
        self.input_login_id       = ''
        self.input_login_password = ''
        self.input_url            = ''
        self.logging_area         = ''
        self.win                  = ''
        # ウィンドウ設定
        self.win = tk.Tk()
        self.win.title("GetBuymaData")
        self.win.geometry("800x580")
        # フレーム設定
        setting_frame = tk.Frame(self.win, width=780, height=300, bd=2, relief='groove')
        setting_frame.place(x=10, y=10)
        logging_frame = tk.Frame(self.win, width=780, height=250, bd=2, relief='groove')
        logging_frame.place(x=10, y=320)
        # ラベル設定
        login_id_label = tk.Label(setting_frame, justify="center", text='login id')
        login_id_label.place(x=150, y=10, width=500, height=30)
        login_password_label = tk.Label(setting_frame, justify="center", text='login password')
        login_password_label.place(x=150, y=80, width=500, height=30)
        url_label = tk.Label(setting_frame, justify="center", text='取得したいデータのURLを張り付けてください')
        url_label.place(x=150, y=150, width=500, height=30)
        logging_label = tk.Label(logging_frame, justify="center", text='LOG')
        logging_label.place(x=150, y=10, width=500, height=30)
        # テキストボックス設定
        self.input_login_id = tk.Entry(justify="center")
        self.input_login_id.place(x=150, y=50, width=500, height=30)
        self.input_login_id.insert(tk.END, "")
        self.input_login_password = tk.Entry(justify="center")
        self.input_login_password.place(x=150, y=120, width=500, height=30)
        self.input_login_password.insert(tk.END, "")
        self.input_url = tk.Entry(justify="center")
        self.input_url.place(x=150, y=190, width=500, height=30)
        self.input_url.insert(tk.END, "")
        # ボタン設定
        # ボタン「データ取得を開始する」を押下するとブラウザに制御が移ってしまい、GUIにログを書き込みが出来なくなってしまう。
        # この為ブラウザを動作させる「activate_get_data_btn」を別スレッド「activate_get_data_btn_thread」として定義し実行「.start」とする。
        # このように対応する事でブラウザとGUIを同時に実行する事を実現する。
        activate_get_data_btn_thread = threading.Thread(target=self.activate_get_data_btn)
        get_data_btn = tk.Button(setting_frame, text='データの取得を開始する', width=70, height=1, command=activate_get_data_btn_thread.start)
        get_data_btn.place(x=140, y=220)
        stop_working_btn = tk.Button(setting_frame, text='終了', width=70, height=1, command=self.activate_stop_working_btn)
        stop_working_btn.place(x=140, y=260)
        # ログエリア設定
        self.logging_area = scrolledtext.ScrolledText(logging_frame,
            wrap = tk.WORD,
            width = 100,
            height = 14,
        ) 
        self.logging_area.place(x=30, y=35)
        self.logging_area.focus()
        # ループ開始
        self.win.mainloop()
    def activate_get_data_btn(self):
        # tkinterのパラメータをbrowserに渡す
        setting_params = {}
        setting_params['input_login_id']       = self.input_login_id.get()
        setting_params['input_login_password'] = self.input_login_password.get()
        setting_params['input_url']            = self.input_url.get()
        # browserでデータ取得実行
        try:
            browserController = BrowserController(self, setting_params)
            browserController.open_buyma()
            browserController.login_buyma()
            item_urls = browserController.get_item_urls()
            browserController.open_item_urls_for_each(item_urls)
            self.activate_logging('全ての処理が完了しました。')
        except:
            self.activate_logging('ブラウザーの操作でエラーが発生しました。')
            self.win.quit()
    def activate_stop_working_btn(self):
        self.win.quit()
    def activate_logging(self, log):
        # ログ書き込み
        dt_now = datetime.datetime.now()
        dt     = str(dt_now.strftime('%Y年%m月%d日%H:%M:%S -- '))
        log    = dt + log + '\n'
        print(log)
        self.logging_area.insert(tk.END, log)
def main():
    # tkinter実行
    tkinterController = TkinterController()
if __name__ == "__main__":
    main()